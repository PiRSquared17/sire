Molecular coordinates and topology file (.mct)

Need to have a new molecular file format. The reason is that there does not appear to be an existing format that allows arbitrary precision, identifies the chemical element of each atom, and can hold multiple, named molecules within a single file. 

All implementations of this format should be able to read the bzip2 versions of the file.

Residues are identified by number. The numbers can be in any order, though must be unique.

Atom names must be unique within a residue. Can mix and match the order throughout
the file as everything is assembled and checked after the entire file is parsed.

The file is case insensitive! (except for %MCT-version, which is case sensitive)

Units of file are Angstrom for distance and A ps-1 for velocity.

%MCT-version_1.0
#comments and blank lines allowed anywhere, must start with %MCT-version 

#can have many 'info' lines, that can provide extra meta information (key value)
info creation_date 21:21 13/2/2005
info created_by chris
info created_on cubert.localdomain
info produced_by ProtoMS3
info box periodic (-5.0,-5.0,-5.0)-(5.0,5.0,5.0)

molecule 1 methane
#can have local 'molinfo' lines that refer to the current molecule
molinfo protoms_type FlexMol
residue 1 met
resinfo 
atom C1 C 3.4534 4.32435 5.3252 (vx vy vz)
atminfo beta 100.0
atom H1 H ...
atom H2 H ...
atom H3 H ...
atom H4 H ...

bond from 1-C1 to 1-H1 1-H2 1-H3 1-H4   # can use a short hand to specify multiple bonds
                                        # to the same atom

molecule 2 alanine dipeptide
residue 1 cterm
atom ...

residue 2 ala
atom ...

residue 3 nterm
atom ...

#optionally can have an 'end' to terminate the file
end  #nothing after this is read

# additional 'info', 'molinfo', 'resinfo' and 'atminfo' are completely optional and 
# implementation defined. Only the molecule, residue and atom lines need to be recognised.
# The atom line must contain the coordinates in columns 4,5,6 with velocities optionally
# in columns 7,8,9

# then parameter file can identify atoms via;

parameter methane
residue met
atom C1 param 1
atoms H1,H2,H3,H4 param 2      #can use a shorthand for parameters

parameter tip4p
residue 1 t4p
atom O00 param 3
atom H01 param 4
atom H02 param 5
atom M03 param 6

perturb from methane to tip4p  #used to assign correspondance between molecules
from 1-C1 to 1-O00             #program uses geometry of reference state for
from 1-H1 to 1-H01             #motion, so use this to describe perturbation
from 1-H2 to 1-H02
from 1-H3 to 1-M03
from 1-H4 to dummy

change bond 1-C1 1-H4 from 1.09 to 0.2
change bond 1-C1 1-H1 from 1.09 to 0.945
change bond 1-C1 1-H2 from 1.09 to 0.945
change bond 1-C1 1-H3 from 1.09 to 0.3
change angle 1-H1 1-C1 1-H2 from 109.45 to 104.5
