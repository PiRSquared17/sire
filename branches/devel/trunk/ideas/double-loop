Need to switch CutGroupRegistry and QFiles in streams to use weak_ptr as matter of urgency!

have CutGroup->isBonded(other) function

if (bondedto.isEmpty()) return false;
else return bondedto.contains(other->id());

have CutGroup->isPerturbable()

return perturbgroup != 0;

CutGroup has functions;

    backwards();
    forwards();
    setLambda(lam);
    
which set/return state based on info contained in PerturbGroup struct.

struct PerturbGroup
{
    CutGroupPtr lam0;
    CutGroupPtr lam1;
    
    CutGroupPtr fwd-group;
    CutGroupPtr bwd-group;
}

for cutgroup i=0, n-2
    for cutgroup j=i+1,n-1
        
        if (not i->isBonded(j))           //inline call
            //do non-bonded energy...
            nrg = this->interNonBonded(i,j);   //virtual function call (contains 2-3 function calls)
        else
            //do bonded energy...
            nrg = this->intraNonBonded(i,j);   //virtual function call (contains 2-3 function calls)
        
        if (not (i->isPerturbable() and j->isPerturbable()) )  //inline calls
            //just copy the energies...
        else
            if (not i->isBonded())  //inline calls
                nrgf = this->interNonBonded(i->forwards,j->forwards);  //virtual (with 2-3 functions)
                nrgb = this->interNonBonded(i->backwards,j->backwards); //virtual (with 2-3 functions)
            else
                nrgf = this->intraNonBonded(i->forwards,j->forwards);  //virtual (with 2-3 functions)
                nrgb = this->intraNonBonded(i->backwards,j->backwards); //virtual (with 2-3 functions)

        if i->hasMonitors         //inline...
            //update monitors...  //virtual function calls...
        if j->hasMonitors         //inline...
            //update monitors...  //virtual function calls...
            
    
note if monitor i,j interaction energy then i is given a monitor that looks for i and j, j is not given 
any monitors!

Monitors work on CutGroups (so that they can collect info directly). Atomistic monitors work by 
recalculating the energy, and are thus less efficient.            


